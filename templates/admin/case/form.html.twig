{% extends 'admin/base.html.twig' %}

{% block title %}{{ case.id ? 'Modifier' : 'Lancer' }} l'appel | Aychek Admin{% endblock %}
{% block page_title %}{{ case.id ? 'Modifier l\'appel: ' ~ case.title : 'Nouvel Appel d\'Offre' }}{% endblock %}

{% block body %}
<div class="glass-panel">
    {{ form_start(form) }}
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 32px;">
        <div class="form-section">
            <h4 style="margin-bottom: 24px; color: var(--brand); border-bottom: 2px solid var(--surface2); padding-bottom: 8px;">Informations de base</h4>
            
            <div class="form-field">
                {{ form_label(form.title, 'Titre de l\'appel', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.title, {'attr': {'class': 'form-input'}}) }}
                {{ form_errors(form.title) }}
            </div>

            <div class="form-field">
                {{ form_label(form.category, 'Catégorie', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.category, {'attr': {'class': 'form-input'}}) }}
                {{ form_errors(form.category) }}
            </div>

            <div class="form-field">
                {{ form_label(form.description, 'Description détaillée', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.description, {'attr': {'class': 'form-input', 'style': 'min-height: 150px'}}) }}
                {{ form_errors(form.description) }}
            </div>

            <div class="form-field">
                {{ form_label(form.location, 'Localisation (Ville)', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.location, {'attr': {'class': 'form-input'}}) }}
                {{ form_errors(form.location) }}
            </div>
        </div>

        <div class="form-section">
            <h4 style="margin-bottom: 24px; color: var(--brand); border-bottom: 2px solid var(--surface2); padding-bottom: 8px;">Objectifs & Statut</h4>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-field">
                    {{ form_label(form.targetAmount, 'Objectif (TND)', {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.targetAmount, {'attr': {'class': 'form-input'}}) }}
                    {{ form_errors(form.targetAmount) }}
                </div>
                <div class="form-field">
                    {{ form_label(form.currentAmount, 'Collecté (TND)', {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.currentAmount, {'attr': {'class': 'form-input'}}) }}
                    {{ form_errors(form.currentAmount) }}
                </div>
            </div>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                <div class="form-field">
                    {{ form_label(form.urgency, 'Niveau d\'urgence', {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.urgency, {'attr': {'class': 'form-input'}}) }}
                    {{ form_errors(form.urgency) }}
                </div>
                <div class="form-field">
                    {{ form_label(form.status, 'Statut actuel', {'label_attr': {'class': 'form-label'}}) }}
                    {{ form_widget(form.status, {'attr': {'class': 'form-input'}}) }}
                    {{ form_errors(form.status) }}
                </div>
            </div>

            <div class="form-field">
                {{ form_label(form.cha9a9aUrl, 'URL Cha9a9a / Document Preuve', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.cha9a9aUrl, {'attr': {'class': 'form-input'}}) }}
                {{ form_errors(form.cha9a9aUrl) }}
            </div>

            <div style="display: flex; gap: 24px; margin-top: 16px; background: var(--bg-subtle); padding: 16px; border-radius: var(--radius-md);">
                <div class="form-field" style="margin-bottom: 0; display: flex; align-items: center; gap: 12px;">
                    {{ form_widget(form.isFeatured) }}
                    {{ form_label(form.isFeatured, 'Mettre en avant', {'label_attr': {'class': 'form-label', 'style': 'margin-bottom: 0'}}) }}
                </div>
            </div>

            <div class="form-field" style="margin-top: 16px;">
                {{ form_label(form.publishedAt, 'Date de publication', {'label_attr': {'class': 'form-label'}}) }}
                {{ form_widget(form.publishedAt, {'attr': {'class': 'form-input'}}) }}
                {{ form_errors(form.publishedAt) }}
            </div>
        </div>
    </div>

    <div style="display: flex; gap: 12px; margin-top: 40px; border-top: 1px solid var(--border); padding-top: 24px;">
        <button class="btn btn-primary" type="submit">
            <i class="fa-solid fa-save" style="margin-right: 8px;"></i> Enregistrer les modifications
        </button>
        <a href="{{ path('admin_case_index') }}" class="btn">Annuler</a>
    </div>
    {{ form_end(form) }}
</div>
{% endblock %}
